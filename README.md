# 结论：
flink简单的 union只是把两个数据流进行联合，**联合后的数据是无序的，两个流不会阻塞对方**。  
除非数据量产生速度过快，导致union算子处理效率跟不上，会影响流的处理速度，但没发现两个流把对方阻塞住的情况。

# 情景一
stream流一秒产生一条  
batch流一秒产生一万条  
union处理效果如下：（两个流是乱序的）  
行号：      流来源   id          数据产生时间  
1148646 +I[batch, 1531227193,  2024-05-25T11:31:45.170]  
1148647 +I[stream, 1837789085, 2024-05-25T11:31:46.767]  
1148648 +I[batch, -186220073,  2024-05-25T11:31:45.170]  
...  
1168627 +I[batch, -730104209,  2024-05-25T11:31:45.356]  
1168628 +I[stream, 1780387907, 2024-05-25T11:31:47.784]  
1168629 +I[batch, 116393968,   2024-05-25T11:31:45.356]  
...  
1262137 +I[batch, 175762318,   2024-05-25T11:31:46.268]  
1262138 +I[stream, 2566663,    2024-05-25T11:31:48.779]  
1262139 +I[batch, 2072637737,  2024-05-25T11:31:46.268]  
...   
1370832 +I[batch, 404405446,   2024-05-25T11:31:47.468]  
1370833 +I[stream, 452891548,  2024-05-25T11:31:49.770]  

# 情景二
stream流一秒产生一条  
batch流一秒产生二条  
union处理效果如下：（看似有序，其实上游两个流是依次交替产生的数据，造成了有序的假象）  
+I[stream, -724733704, 2024-05-25T11:40:41.588]  
+I[batch, 773414045,   2024-05-25T11:40:42.229]  
+I[batch, -593910440,  2024-05-25T11:40:42.231]  
+I[stream, -1433230835,2024-05-25T11:40:42.585]  
+I[batch, 1745205664,  2024-05-25T11:40:43.233]  
+I[batch, 2073467007,  2024-05-25T11:40:43.234]  
+I[stream, 1194792816, 2024-05-25T11:40:43.587]  

备注：如果控制台打印输出太多不方便查看，可以勾选idea的save console output to file